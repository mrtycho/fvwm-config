ModulePath $[FVWM_USERDIR]:+

SetEnv fvwm_theme "magic"

ImagePath $[FVWM_USERDIR]/themes/$[fvwm_theme]:$[FVWM_USERDIR]/3dpixmaps:+

*FvwmScript: Path $[FVWM_USERDIR]/scripts

InfoStoreAdd filemanager caja
InfoStoreAdd editor mousepad
InfoStoreAdd terminal xterm
InfoStoreAdd browser firefox
InfoStoreAdd mail thunderbird
InfoStoreAdd viewer gthumb
InfoStoreAdd videoplayer vlc
InfoStoreAdd audioplayer audacious
InfoStoreAdd help yelp

InfoStoreAdd smallfont  "Shadow=1 0 SE:xft:DejaVu Sans:size=8::minspace=False:antialias=True"
InfoStoreAdd normalfont "xft:DejaVu Sans:size=9:minspace=False:antialias=True"
InfoStoreAdd titlefont  "Shadow=1 0 SE:xft:DejaVu Sans:size=9:minspace=False:antialias=True"

DeskTopSize 2x2

ExecUseShell /bin/bash
Emulate Win
HideGeometryWindow Move
IgnoreModifiers L2
ClickTime 550
OpaqueMoveSize 100

EdgeScroll 0 0
EdgeResistance 500
EdgeThickness 1

BusyCursor DynamicMenu True, Read True

CursorStyle ROOT         left_ptr
CursorStyle TITLE        left_ptr
CursorStyle DEFAULT      left_ptr
CursorStyle SYS          left_ptr
CursorStyle MENU         left_ptr

Read $[FVWM_USERDIR]/themes/$[fvwm_theme]/theme

Style * ClickToFocus
Style * MouseFocusClickRaises
Style * TileCascadePlacement
Style * ResizeOpaque
Style * WindowShadeSteps 20
Style * SnapAttraction 5
Style * UsePPosition
Style * GrabFocus, GrabFocusTransient
Style * !FPReleaseFocus
Style * FPLenient
Style * IconBox 10 5 -10 -5, IconGrid 15 15, IconFill left bottom
Style * DecorateTransient, DontLowerTransient, UseTransientPPosition
Style * MWMFunctions
Style * MWMDecor
Style * HintOverride
Style * OLDecor
Style * EWMHUseStateHints
Style * GNOMEUseHints
Style * IconOverride

Style panel     Sticky, !Title, WindowListSkip, CirculateSkip, BorderWidth 0
Style "gthumb"  !GNOMEUseHints, EWMHIgnoreWindowType, !MWMDecor
Style "Catfish"  !GNOMEUseHints, EWMHIgnoreWindowType, !MWMDecor
Style "tint2" 	!Title, !Handles, !Borders, StaysOnTop, EWMHIgnoreStrutHints, Sticky, EWMHPlacementIgnoreWorkingArea, NeverFocus, WindowListSkip
Style desktop_icon CirculateSkip, WindowListSkip,  NoTitle
Style *lock        !Title, !Handles, Sticky, WindowListSkip
Style stalonetray  !Title, !Handles, WindowListSkip, CirculateSkip, StaysOnBottom,NeverFocus, EWMHUseStackingOrderHints
Style FvwmForm-QuitVerify NoButton 1, NoButton 2, NoButton 4, NoButton 6, StaysOnTop, NoHandles, WindowListSkip

#------------------------------------------------------------------------------
# Menus
#------------------------------------------------------------------------------
Read menus

#------------------------------------------------------------------------------
# Functions
#------------------------------------------------------------------------------

DestroyFunc MoveOrRaiseOrShade
AddToFunc MoveOrRaiseOrShade I Focus
+ I Raise
+ M Move
+ C Raise
+ D WindowShade

DestroyFunc MoveOrRaiseOrMaximize
AddToFunc MoveOrRaiseOrMaximize I Focus
+ I Raise
+ M Move
+ C Raise
+ D Maximize

DestroyFunc MoveOrIconifyOrRaise
AddToFunc MoveOrIconifyOrRaise I Focus
+ M Move
+ D Iconify
+ C Raise

DestroyFunc IconifyOrFocusAndRaise
AddToFunc IconifyOrFocusAndRaise
+ I ThisWindow (CurrentPage,!Iconic,Focused) Iconify
+ I TestRc (Match) Break 
+ I Iconify -1
+ I Raise
+ I ThisWindow (AcceptsFocus) Focus

DestroyFunc MaximizeWindow
AddToFunc MaximizeWindow
+ C Maximize

DestroyFunc IconifyWindow
AddToFunc IconifyWindow
+ C Iconify

DestroyFunc CloseWindow
AddToFunc CloseWindow
+ C Close

DestroyFunc RaiseLowerKey
AddToFunc RaiseLowerKey
+ I ThisWindow (!Overlapped) Lower
+ I TestRc (Match) TransferFocus

DestroyFunc RaiseLowerWindow
AddToFunc RaiseLowerWindow
+ C ThisWindow (!Overlapped) Lower
+ C TestRc (Match) TransferFocus

DestroyFunc WindowListFunc
AddToFunc WindowListFunc
+ I ThisWindow Iconify off
+ I ThisWindow Raise
+ I ThisWindow Focus

DestroyFunc FuncFvwmNextWindow
AddToFunc FuncFvwmNextWindow
+ I Next (CurrentPage, !Iconic, AcceptsFocus) FlipFocus NoWarp
+ I Current Raise

DestroyModuleConfig FE-Focus: *
*FE-Focus: iconify TransferFocus
*FE-Focus: destroy_window TransferFocus
AddToFunc TransferFocus
 + I Prev (!Iconic, CurrentPage, !Overlapped, AcceptsFocus) Focus
 + I TestRc (NoMatch) ThisWindow (CurrentPage,!Overlapped,AcceptsFocus,!Iconic) Focus

DestroyFunc SetNitrogenBackground
AddToFunc   SetNitrogenBackground
+ I Exec exec nitrogen --restore
+ I Exec nitrogen
+ I TestRc (Match) Exec echo "nitrogen --restore" > $[FVWM_USERDIR]/background.cfg

#------------- FvwmManPage

DestroyFunc ViewManPage
AddToFunc   ViewManPage
+ I Exec exec yelp man:$0 #$[infostore.terminal] -g 80x40 -e man $0

#------------------------------------------------------------------------------
# Mouse Bindings
#------------------------------------------------------------------------------

Mouse 1		R   	A       Menu Utilities mouse -1p -1p
Mouse 2		R    	A       Menu Window mouse -1p -1p
Mouse 3         R       A       WindowList mouse -1p -1p
Mouse 3         R       C       WindowList mouse -1p -1p OnlyListSkip

Mouse 1		W   	M       Menu Utilities mouse -1p -1p
Mouse 2		W    	M       Menu Window mouse -1p -1p
Mouse 3         W       M       WindowList (CurrentPage) mouse -1p -1p 
Mouse 3         W       CM      WindowList mouse -1p -1p OnlyListSkip

Mouse 1		I	A	Function "MoveOrIconifyOrRaise"
Mouse 2		I	A	Iconify
Mouse 3		I	A	Menu Window-Ops3 c+0 -101m

#------------------------------------------------------------------------------
# Key Bindings
#------------------------------------------------------------------------------

Key F4		A	M	Close
Key F4		A	MS	Destroy
Key F5		A	M	RaiseLowerKey
Key F6		A	M	All (Iconic) Raise  # originally Restore
Key F7		A	M	Move
Key F8		A	M	Resize
Key F9		A	M	Iconify
Key F10		A	M	Maximize 100 100
Key F11		A	M	FvwmIdent
Key F12		A	M	FvwmConsole

Key Left     A        SM        GotoPage -1p +0p
Key Right    A        SM        GotoPage +1p +0p
Key Up       A        SM        GotoPage +0p -1p
Key Down     A        SM        GotoPage +0p +1p

Silent Key Tab A M FuncFvwmNextWindow

# Rofi
Key Space A C Exec exec rofi -show run

# Lock screen
Key L A MC Exec exec xscreensaver-command -l

#------------------------------------------------------------------------------
# Modules
#------------------------------------------------------------------------------

Read $[FVWM_USERDIR]/themes/$[fvwm_theme]/modules

#------------------------------------------------------------------------------
# Start
#------------------------------------------------------------------------------

AddToFunc StartFunction
#+ I Test (Init) Exec exec /usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1 & eval $(gnome-keyring-daemon -s --components=pkcs11,secrets,ssh,gpg) &
+ I Test (Init) Exec exec /usr/bin/lxpolkit & eval $(gnome-keyring-daemon -s --components=pkcs11,secrets,ssh,gpg) &
+ I Exec exec $(source $[FVWM_USERDIR]/background.cfg)
+ I Test (Init) Exec exec nm-applet
+ I Test (Init) Exec exec pnmixer
+ I Test (Init) Exec exec xscreensaver -no-splash
+ I Test (Init) Exec exec redshift
+ I Test (Init) Exec exec xfce4-power-manager
+ I Function StartModules
+ I FvwmEvent FE-Focus

AddToFunc ExitFunction
+ I Exec killall stalonetray